<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Easy Order Portal Login Page</title>
    <style> 

	@font-face {
	    font-family: 'Sansa';
	    src: url("https://raw.githubusercontent.com/TRod-Dev/Puratos_EOP_Test/main/Sansa.ttf") format("truetype");
	    font-weight: normal;
	    font-style: normal;
	}
	
	@font-face {
	    font-family: 'Century Gothic';
	    src: url("https://raw.githubusercontent.com/TRod-Dev/Puratos_EOP_Test/main/centurygothic.ttf") format("truetype");
	    font-weight: normal;
	    font-style: normal;
	}
	
	@font-face {
	    font-family: 'Karmina';
	    src: url("https://raw.githubusercontent.com/TRod-Dev/Puratos_EOP_Test/main/Karmina%20Regular.otf") format("opentype");
	    font-weight: normal;
	    font-style: normal;
	}

	body, html {
		font-family: 'Century Gothic','Sansa','Karmina';
	}

	h1 {
		font-size: 20px;
	}

	body {
		max-width: 100%;
	    margin: auto;
	    text-align: center;
	    background-image: none;
		background-color: white;
	    color: black;
	    height: fit-content;
	    height: 100%;
	    background-position: center;
	    background-repeat: no-repeat;
	    background-size: cover;
	}

	button {
		width: 100%;
		max-width: 400px; /* Keep buttons the same width as inputs */
		padding: 10px;
		border-radius: 25px;
		border: none;
		font-weight: bold;
		background-color: rgb(209, 0, 52);
		color: white;
		cursor: pointer;
		margin-top: 10px;
	}

	button:disabled {
		background-color: #ccc;
	}

	label {
		display:none;
	}

	#layer {
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		display: flex;
		flex-direction: column;
		align-items: center;
		justify-content: center;
		background-color: #f5f4f4;
	}

	#logo {
		position: absolute;
		top: 0;
		height: 150px;
		width: 100%;
		background-position: left;
		background-repeat: no-repeat;
		background-size: contain;
		background-image: url("https://trod-dev.github.io/Puratos_EOP_Test/Puratos-Logo.png");
		background-color: white;
		border-bottom: 1px solid #cfcfcf;
	}

	input {
		width: 90%;
		padding: 10px;
		margin: 10px 0;
		border-radius: 25px;
		border: 1px solid black;
		font-weight: bold;
		text-align: center;
	}

	#api {
		width: 300px;
		background: rgba(255, 255, 255, 0.8);
		padding: 20px;
		border-radius: 10px;
		box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
		display: flex;
		flex-direction: column;
		align-items: center;
	}

	#attributeVerification{
		width:100%;
	}

	#emailVerificationControl_but_send_code {
		padding: 10px;
		width: 100%;
		color: white;
		font-weight: bold;
		background-color: rgb(209, 0, 52);
		margin-top: 10px;
		border-radius: 25px;
		border: none;
		cursor: pointer;
	}

	@media only screen and (max-height: 400px) {
		#logo {
			display: none;
		}
	}

	#cancel{
		display:none;
	}

	li.no-marker::marker {
		content: none; 
	}

	a{
		display:none;
	}

	marker {
		display: none; 
	}

	li{
		display:block;
	}

	ul{
		padding:0px;
	}

	#continue{
		display:none;
	}

	#emailVerificationControl_success_message {
		display: none;
	}
	
	.back-button {
		background: transparent;
		color: blue;
		cursor: pointer;
		border: none;
		width: fit-content;
		position: absolute;
		top: 150px;
		left: 50px;
	}

    </style>
</head>
<body>
	<div id="layer">
		<div id="logo"></div>
		<button type="button" class="back-button" onclick="history.back();">« Back</button>
		<div id="api"></div>
	</div>
<script>		
window.addEventListener('load', () => {
  const apiDiv = document.getElementById('api');
  if (!apiDiv) {
    console.warn('[B2C-CustomUI] No #api container — aborting custom script');
    return;
  }

  // Wait until B2C injects its UI
  const observer = new MutationObserver((mutations, obs) => {
    if (apiDiv.children.length > 0) {
      obs.disconnect();
      initB2CScript(apiDiv);
    }
  });

  observer.observe(apiDiv, { childList: true, subtree: true });
});

function initB2CScript(root) {
  console.log('[B2C-CustomUI] B2C UI loaded — scanning DOM');

  // Debug: list all elements under #api (optional — helps you inspect the UI)
  dumpDOM(root);

  // Attempt to find relevant elements:
  const codeInput = root.querySelector('input[type="text"], input[type="tel"], input[type="number"], input[name="verificationCode"]');
  const continueButton = root.querySelector('button, input[type="submit"]');
  // (You can adjust selectors above as needed.)

  if (!codeInput) {
    console.warn('[B2C-CustomUI] No code input found in B2C UI — verification step may use a different selector.');
  } else {
    console.log('[B2C-CustomUI] Found code input:', codeInput);
  }

  if (!continueButton) {
    console.warn('[B2C-CustomUI] No continue/submit button found in B2C UI.');
  } else {
    console.log('[B2C-CustomUI] Found button:', continueButton);
  }

  // If both found, hook up validation for a 6-digit code to auto-enable button:
  if (codeInput && continueButton) {
    continueButton.disabled = true;

    codeInput.addEventListener('input', () => {
      const v = codeInput.value.trim();
      const ok = /^\d{6}$/.test(v);
      continueButton.disabled = !ok;
      // Optionally: auto-click when valid
      // if (ok) { continueButton.click(); }
    });
  }
}

// Utility: dump the DOM under #api for inspection
function dumpDOM(el, depth = 0) {
  el.childNodes.forEach(node => {
    if (node.nodeType === Node.ELEMENT_NODE) {
      const indent = ''.padStart(depth * 2, ' ');
      console.log(`${indent}<${node.tagName.toLowerCase()} id="${node.id}" class="${node.className}">`);
      dumpDOM(node, depth + 1);
    }
  });
}

</script>
</body>
</html>
